 unsigned char i;
 unsigned char j; 
/*Port Definitions*/
int Max7219_pinCLK = 10;
int Max7219_pinCS = 9;
int Max7219_pinDIN = 8;
 
unsigned char disp1[90][8]={  //numero comandi
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 1
{B00010000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 2
{B00010000,
B00010000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 3
{B00010000,
B00010000,
B00010000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 4
{B00010000,
B00010000,
B00010000,
B00010000,
B00000000,
B00000000,
B00000000,
B00000000}, // 5
{B00000000,
B00010000,
B00010000,
B00010000,
B00010000,
B00000000,
B00000000,
B00000000}, // 6
{B00000000,
B00000000,
B00010000,
B00010000,
B00010000,
B00010000,
B00000000,
B00000000}, // 7
{B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B00010000,
B00010000,
B00000000}, // 8
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B00010000,
B00010000}, // 9
{B11100000,
B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B00010000,
B00010000}, // 10
{B10000000,
B11100000,
B00000000,
B00000000,
B00010000,
B00010000,
B00010000,
B00010000}, // 11
{B00000000,
B10000000,
B11100000,
B00000000,
B00010000,
B00010000,
B00010000,
B00010000}, // 12
{B00000000,
B00000000,
B10000000,
B11100000,
B00010000,
B00010000,
B00010000,
B00010000}, // 13
{B00000000,
B00000000,
B00000000,
B10000000,
B11110000,
B00010000,
B00010000,
B00010000}, // 14
{B00000000,
B00000000,
B00000000,
B00000000,
B10010000,
B11110000,
B00010000,
B00010000}, // 15
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B10010000,
B11110000,
B00010000}, // 16
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B10010000,
B11110000}, // 17
{B00001111,
B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B10010000,
B11110000}, // 18
{B00000000,
B00001111,
B00000000,
B00000000,
B00010000,
B00010000,
B10010000,
B11110000}, // 19
{B00000000,
B00000000,
B00001111,
B00000000,
B00010000,
B00010000,
B10010000,
B11110000}, // 20
{B00000000,
B00000000,
B00000000,
B00001111,
B00010000,
B00010000,
B10010000,
B11110000}, // 21
{B00000000,
B00000000,
B00000000,
B00000000,
B00011111,
B00010000,
B10010000,
B11110000}, // 22
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B00011111,
B10010000,
B11110000}, // 23
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B10011111,
B11110000}, // 24
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B10010000,
B11111111}, // 25
{B01100000,
B00000000,
B00000000,
B00000000,
B00010000,
B00010000,
B10010000,
B11111111}, // 26
{B01100000,
B01100000,
B00000000,
B00000000,
B00010000,
B00010000,
B10010000,
B11111111}, // 27
{B00000000,
B01100000,
B01100000,
B00000000,
B00010000,
B00010000,
B10010000,
B11111111}, // 28
{B00000000,
B00000000,
B01100000,
B01100000,
B00010000,
B00010000,
B10010000,
B11111111}, // 29
{B00000000,
B00000000,
B00000000,
B01100000,
B01110000,
B00010000,
B10010000,
B11111111}, // 30
{B00000000,
B00000000,
B00000000,
B00000000,
B01110000,
B01110000,
B10010000,
B11111111}, // 31
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B01110000,
B11110000,
B11111111}, // 32
{B00000111,
B00000000,
B00000000,
B00000000,
B00010000,
B01110000,
B11110000,
B11111111}, // 33
{B00000100,
B00000111,
B00000000,
B00000000,
B00010000,
B01110000,
B11110000,
B11111111}, // 34
{B00000000,
B00000100,
B00000111,
B00000000,
B00010000,
B01110000,
B11110000,
B11111111}, // 35
{B00000000,
B00000000,
B00000100,
B00000111,
B00010000,
B01110000,
B11110000,
B11111111}, // 36
{B00000000,
B00000000,
B00000000,
B00000100,
B00010111,
B01110000,
B11110000,
B11111111}, // 37
{B00000000,
B00000000,
B00000000,
B00000000,
B00010100,
B01110111,
B11110000,
B11111111}, // 38
{B00000000,
B00000000,
B00000000,
B00000000,
B00010000,
B01110100,
B11110111,
B11111111}, // 39
{B00001000,
B00000000,
B00000000,
B00000000,
B00010000,
B01110100,
B11110111,
B11111111}, // 40
{B00001000,
B00001000,
B00000000,
B00000000,
B00010000,
B01110100,
B11110111,
B11111111}, // 41
{B00001100,
B00001000,
B00001000,
B00000000,
B00010000,
B01110100,
B11110111,
B11111111}, // 42
{B00000000,
B00001100,
B00001000,
B00001000,
B00010000,
B01110100,
B11110111,
B11111111}, // 43
{B00000000,
B00000000,
B00001100,
B00001000,
B00011000,
B01110100,
B11110111,
B11111111}, // 44
{B00000000,
B00000000,
B00000000,
B00001100,
B00011000,
B01111100,
B11110111,
B11111111}, // 45
{B00000000,
B00000000,
B00000000,
B00000000,
B00011100,
B01111100,
B11111111,
B11111111}, // 46
{B00000011,
B00000000,
B00000000,
B00000000,
B00011100,
B01111100,
B11111111,
B11111111}, // 47
{B00000011,
B00000011,
B00000000,
B00000000,
B00011100,
B01111100,
B11111111,
B11111111}, // 48
{B00000000,
B00000011,
B00000011,
B00000000,
B00011100,
B01111100,
B11111111,
B11111111}, // 49
{B00000000,
B00000000,
B00000011,
B00000011,
B00011100,
B01111100,
B11111111,
B11111111}, // 50
{B00000000,
B00000000,
B00000000,
B00000011,
B00011111,
B01111100,
B11111111,
B11111111}, // 51
{B00000000,
B00000000,
B00000000,
B00000000,
B00011111,
B01111111,
B11111111,
B11111111}, // 52
{B10000000,
B00000000,
B00000000,
B00000000,
B00011111,
B01111111,
B11111111,
B11111111}, // 53
{B11100000,
B10000000,
B00000000,
B00000000,
B00011111,
B01111111,
B11111111,
B11111111}, // 54
{B00000000,
B11100000,
B10000000,
B00000000,
B00011111,
B01111111,
B11111111,
B11111111}, // 55
{B00000000,
B00000000,
B11100000,
B10000000,
B00011111,
B01111111,
B11111111,
B11111111}, // 56
{B00000000,
B00000000,
B00000000,
B11100000,
B10011111,
B01111111,
B11111111,
B11111111}, // 57
{B00000000,
B00000000,
B00000000,
B00000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 58
{B11000000,
B00000000,
B00000000,
B00000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 59
{B10000000,
B11000000,
B00000000,
B00000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 60
{B10000000,
B10000000,
B11000000,
B00000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 61
{B00000000,
B10000000,
B10000000,
B11000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 62
{B00000111,
B10000000,
B10000000,
B11000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 63
{B00000001,
B10000111,
B10000000,
B11000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 64
{B00000000,
B10000001,
B10000111,
B11000000,
B11111111,
B11111111,
B11111111,
B11111111}, // 65
{B00000000,
B10000000,
B10000001,
B11000111,
B11111111,
B11111111,
B11111111,
B11111111}, // 66
{B00111000,
B10000000,
B10000001,
B11000111,
B11111111,
B11111111,
B11111111,
B11111111}, // 67
{B00100000,
B10111000,
B10000001,
B11000111,
B11111111,
B11111111,
B11111111,
B11111111}, // 68
{B00000000,
B10100000,
B10111001,
B11000111,
B11111111,
B11111111,
B11111111,
B11111111}, // 69
{B00000000,
B10000000,
B10100001,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 70
{B00011110,
B10000000,
B10100001,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 71
{B00000000,
B10011110,
B10100001,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 72
{B00000000,
B10000000,
B10111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 73
{B01000000,
B10000000,
B10111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 74
{B01000000,
B11000000,
B10111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 75
{B11000000,
B11000000,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 76
{B11000111,
B11000000,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 77
{B11000001,
B11000111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 78
{B11001001,
B11000111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 79
{B11001111,
B11001111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 80
{B11111111,
B11001111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 81
{B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111,
B11111111}, // 82
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 83
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 84
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 85
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 86
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 87
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 88
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 89
{B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000,
B00000000}, // 90


};
 
 
 
void Write_Max7219_byte(unsigned char DATA) 
{   
            unsigned char i;
      digitalWrite(Max7219_pinCS,LOW);    
      for(i=8;i>=1;i--)
          {     
             digitalWrite(Max7219_pinCLK,LOW);
             digitalWrite(Max7219_pinDIN,DATA&0x80);// Extracting a bit data
             DATA = DATA<<1;
             digitalWrite(Max7219_pinCLK,HIGH);
           }                                 
}
 
 
void Write_Max7219(unsigned char address,unsigned char dat)
{
        digitalWrite(Max7219_pinCS,LOW);
        Write_Max7219_byte(address);           //address，code of LED
        Write_Max7219_byte(dat);               //data，figure on LED 
        digitalWrite(Max7219_pinCS,HIGH);
}
 
void Init_MAX7219(void)
{
 Write_Max7219(0x09, 0x00);       //decoding ：BCD
 Write_Max7219(0x0a, 0x03);       //brightness 
 Write_Max7219(0x0b, 0x07);       //scanlimit；8 LEDs
 Write_Max7219(0x0c, 0x01);       //power-down mode：0，normal mode：1
 Write_Max7219(0x0f, 0x00);       //test display：1；EOT，display：0
}
 
 
 
void setup()
{
 
  pinMode(Max7219_pinCLK,OUTPUT);
  pinMode(Max7219_pinCS,OUTPUT);
  pinMode(Max7219_pinDIN,OUTPUT);
  delay(50);
  Init_MAX7219();
}
 
 
void loop()
{ 
   for(j=0;j<90;j++)   //loop comandi
  {
   for(i=1;i<9;i++)
    Write_Max7219(i,disp1[j][i-1]);
   delay(300);
  }     
}
